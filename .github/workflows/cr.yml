name: Code Review
on:
  pull_request_target:
    types:
      - labeled     # Triggers when a label is added to the PR

# fix: GraphQL: Resource not accessible by integration (addComment) error
permissions:
  pull-requests: write

jobs:
  setup-deepseek-review:
    runs-on: ubuntu-latest
    name: Code Review
    steps:
      - name: DeepSeek Code Review
        uses: hustcer/deepseek-review@v1
        with:
          base-url: https://api.proxyapi.ru/deepseek
          github-token: ${{ secrets.G_TOKEN }}
          chat-token: ${{ secrets.OPENAI_API_KEY }}
          sys-prompt: "You are a professional TypeScript/React code review assistant responsible for analyzing code changes in GitHub Pull Requests. Identify potential issues such as code style violations, logical errors, security vulnerabilities, and provide improvement suggestions. Don't spend time commenting on what is already working good. Clearly list the problems and recommendations in a concise manner."
